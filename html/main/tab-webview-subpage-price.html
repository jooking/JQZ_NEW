<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>行情</title>
		<meta http-equiv="Access-Control-Allow-Origin" content="*">
		<meta http-equiv="content-security-policy">
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
	</head>
		<link rel="stylesheet" href="../../css/mui.min.css">
		<link rel="stylesheet" href="../../css/quotation.css">
		<style>
			html,body {
				background-color: rgb(29,33,39);
			}
			.title{
				margin: 20px 15px 10px;
				color: #6d6d72;
				font-size: 15px;
			}
		</style>
	<script>
	//该函数将小数点保留至两位，不足两位的补0
	function changeTwoDecimal_f(x)  {  
				var f_x = parseFloat(x);  
				if (isNaN(f_x))  
				{  
				return false;  
				}  
				var f_x = Math.round(x*100)/100;  
				var s_x = f_x.toString();  
				var pos_decimal = s_x.indexOf('.');  
				if (pos_decimal < 0)  
				{  
				pos_decimal = s_x.length;  
				s_x += '.';  
				}  
				while (s_x.length <= pos_decimal + 2)  
				{  
				s_x += '0';  
				}  
				return s_x;  
	}  
		var result = {
"resultcode":"200",
"reason":"SUCCESSED!",
"result":[
	{"data":{
	"buyFive":"0",
	"buyFivePri":"0",
	"buyFour":"0",
	"buyFourPri":"0",
	"buyOne":"0",
	"buyOnePri":"0",
	"buyThree":"0",
	"buyThreePri":"0",
	"buyTwo":"0",
	"buyTwoPri":"0",
	"competitivePri":"0",
	"date":"2016-04-26",
	"gid":"sh000001",
	"increPer":"0.61",
	"increase":"18.0293",
	"name":"上证指数",
	"nowPri":"2964.6997",
	"reservePri":"0",
	"sellFive":"0",
	"sellFivePri":"0",
	"sellFour":"0",
	"sellFourPri":"0",
	"sellOne":"0",
	"sellOnePri":"0",
	"sellThree":"0",
	"sellThreePri":"0",
	"sellTwo":"0",
	"sellTwoPri":"0",
	"time":"15:03:58",
	"todayMax":"2965.4291",
	"todayMin":"2933.9707",
	"todayStartPri":"2944.7156",
	"traAmount":"134292458713",
	"traNumber":"1177116",
	"yestodEndPri":"2946.6704"},
	"dapandata":{
	"dot":"2964.6997",
	"name":"上证指数",
	"nowPic":"18.0293",
	"rate":"0.61",
	"traAmount":"13429246",
	"traNumber":"1177116"},
	"gopicture":{"minurl":"http://image.sinajs.cn/newchart/min/n/sh000001.gif","dayurl":"http://image.sinajs.cn/newchart/daily/n/sh000001.gif","weekurl":"http://image.sinajs.cn/newchart/weekly/n/sh000001.gif","monthurl":"http://image.sinajs.cn/newchart/monthly/n/sh000001.gif"}}],"error_code":0}
		function test(){
			var gg = {"attributes":null,"obj":[{"name":"上证指数","code":null,"chengjiaoliang":"131487344","jinkai":"2896.1623","zuoshou":"2913.2476","zuigao":"2896.1623","chengjiaoe":"138227705361","zuidi":"2842.0143"}],"msg":null,"jsonStr":"{\"obj\":[{\"chengjiaoe\":\"138227705361\",\"chengjiaoliang\":\"131487344\",\"jinkai\":\"2896.1623\",\"name\":\"上证指数\",\"zuidi\":\"2842.0143\",\"zuigao\":\"2896.1623\",\"zuoshou\":\"2913.2476\"}],\"success\":true}","success":true}		
				getDot("sh000001","dot1","dot1detail");
				getDot("sz399001","dot2","dot2detail")
				//getDot("sz899001","dot3")
				getDot("sz399006","dot4","dot4detail")
					
		}
		function getDot(gid,id,detailId){
			mui.ajax('http://10.150.0.61:8080/criomp/demoController.do?getAjax',{
						data:{
							code:gid,
						},
						dataType:'html',//服务器返回json格式数据
						type:'post',//HTTP请求类型
						timeout:10000,//超时时间设置为10秒；changeTwoDecimal_f
						success:function(data){
							 var d= eval("(" + data + ")");
							 var t1= changeTwoDecimal_f(parseFloat(d.obj[0].zonghezhishu));
							 var t2 = changeTwoDecimal_f(parseFloat(d.obj[0].zuoshou));
							 var t3 = changeTwoDecimal_f(t1-t2);
							 var t4 = changeTwoDecimal_f((t3/t2)*100);
							
							if(t3>0){
								document.getElementById(id).style.color="#FF0000";
								document.getElementById(detailId).style.color="#FF0000";
								document.getElementById(detailId).style.fontSize="8px";
							}else{
								document.getElementById(id).style.color="#008000";
								document.getElementById(detailId).style.color="green";
								document.getElementById(detailId).style.fontSize="8px";
							}
							document.getElementById(id).innerHTML=t1;
							document.getElementById(detailId).innerHTML=t3+"&nbsp;"+t4+"%";
						},
						error:function(xhr,type,errorThrown){
							console.log(type);
						}
					});
		}
	</script>
	</head>
	<body onload="test()">
		<div class="mui-content">
		<div class="main">
						<div class="quotation" id="quotation1">
								国内行情
						</div>
					<div class="whiteLine"></div>
						<div class="data" id="data2">
								<br />
								<div style="float: left;padding-right: 15%;" id="click1" >
								<p class="white" >上证指数</p>
								<p class="red"  id="dot1"></p>
								<p class="white" id="dot1detail">-- --</p>
								<br />
								</div>
								<div style="float: left;padding-right: 15%;margin-right:15px;" id="click2">
								<p class="white">深证指数</p>
								<p class="red"  id="dot2"></p>
								<p class="white" id="dot2detail">-- --</p>
								<br />
								</div>
								
								<div style="">
								<p class="white">创业板</p>
								<p class="red" id="dot4"></p>
								<p class="white" id="dot4detail">-- --</p>
								<br />
								</div>
						</div>
					<div class="whiteLine"></div>
						<div class="quotation" id="quotation2">
								国际行情
						</div>
					<div class="whiteLine"></div>
						<div class="data2" id="data2">
								<br />
								<p class="white">上证指数</p>
								<p class="red">1245.96</p>
								<p class="white">+19 +26</p>
								<br />
								<p class="white">上证指数</p>
								<p class="red">1245.96</p>
								<p class="white">+19 +26</p>
						</div>
				</div>
			</div>
	</body>
	<script src="../../js/mui.min.js"></script>
	<script type="text/javascript" src="../../js/md5.js" ></script>
	<script>
		mui.init({
			swipeBack:false //启用右滑关闭功能
		});
		document.getElementById('click1').addEventListener('tap',function(){
		mui.openWindow({
							url: 'tab-webview-subpage-details.html', 
							id: 'detail',
							extras:{
        					gid:'sh000001',
        					dataType:'sh',
    					},
							preload: false,
							show: {
								aniShow: 'pop-in'
							},
							styles: {
								popGesture: 'hide'
							},
							waiting: {
								autoShow: false
							}
						});
	});
	document.getElementById('click2').addEventListener('tap',function(){
		mui.openWindow({
							url: 'tab-webview-subpage-details.html', 
							id: 'detail',
							extras:{
        					gid:'sz399001',
        					dataType:'sz',
    					},
							preload: false,
							show: {
								aniShow: 'pop-in'
							},
							styles: {
								popGesture: 'hide'
							},
							waiting: {
								autoShow: false
							}
						});
	});
		
	</script>
</html>